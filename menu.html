<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ê¸°ëŠ¥ ì„ íƒ | ì „ë‚¨ê²½ì°° ì™¸êµ­ì¸ ì§€ì› ì„œë¹„ìŠ¤</title>
  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f5f5f5;
      color: #222;
      display: flex;
      justify-content: center;
    }

    .app-container {
      width: 100%;
      max-width: 480px;
      min-height: 100vh;
      background: #ffffff;
      display: flex;
      flex-direction: column;
    }

    /* í—¤ë” */
    header {
      background: #003366;
      color: #ffffff;
      padding: 10px 12px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .back-btn {
      width: 40px;
      height: 40px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.35);
      background: rgba(0, 0, 0, 0.15);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      flex-shrink: 0;
    }

    .back-icon {
      font-size: 26px;
      font-weight: 900;
      color: #ffeb3b;
      line-height: 1;
      text-shadow: 0 0 4px rgba(0,0,0,0.8);
    }

    .title-box {
      display: flex;
      flex-direction: column;
      min-width: 0;
    }

    .title-main {
      font-size: 1rem;
      font-weight: 700;
    }

    .title-sub {
      font-size: 0.78rem;
      opacity: 0.9;
      margin-top: 2px;
    }

    .lang-pill {
      margin-left: auto;
      font-size: 0.8rem;
      padding: 4px 8px;
      border-radius: 999px;
      background: rgba(0,0,0,0.15);
      display: flex;
      align-items: center;
      gap: 4px;
      white-space: nowrap;
    }

    .lang-flag {
      font-size: 1rem;
    }

    .lang-name {
      font-size: 0.78rem;
    }

    main {
      flex: 1;
      padding: 12px;
      background: #f5f5f5;
    }

    .menu-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .menu-card {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
      border-radius: 12px;
      background: #ffffff;
      text-decoration: none;
      color: inherit;
      box-shadow: 0 1px 3px rgba(0,0,0,0.08);
      border: 1px solid #eef1f6;
      transition: transform .05s ease, box-shadow .15s ease, border-color .15s ease;
    }

    .menu-card:hover {
      box-shadow: 0 2px 6px rgba(0,0,0,0.10);
      border-color: #dfe7f5;
    }

    .menu-card:active {
      transform: scale(0.985);
    }

    .menu-card-main {
      display: flex;
      flex-direction: column;
      gap: 3px;
      flex: 1;
      min-width: 0;
    }

    .menu-card-title {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.9rem;
      font-weight: 600;
      color: #111;
    }

    .menu-card-icon {
      font-size: 1.1rem;
    }

    /* ë‹¤êµ­ì–´ ì•ˆì „ì „ë‚¨ ì•± ì•„ì´ì½˜(ì´ë¯¸ì§€) ì „ìš© ìŠ¤íƒ€ì¼ */
    .menu-card-icon.safe-app-icon {
      width: 26px;
      height: 26px;
      border-radius: 6px;
      background: #ffffff;
      background-image: url("img/safe-jeonnam.png"); /* ì—¬ê¸° íŒŒì¼ëª…ì„ ì‹¤ì œ ì €ì¥í•œ ì•„ì´ì½˜ ì´ë¦„ê³¼ ë§ì¶”ì„¸ìš” */
      background-size: cover;
      background-position: center;
      display: inline-block;
      font-size: 0; /* ì´ ì•ˆì˜ ê¸€ìëŠ” ë³´ì´ì§€ ì•Šê²Œ */
    }

    .menu-card-desc {
      font-size: 0.78rem;
      color: #555;
      line-height: 1.3;
    }

    .menu-card-arrow {
      font-size: 1.1rem;
      color: #bbb;
      font-weight: 800;
    }

    footer {
      padding: 8px 12px 12px;
      font-size: 0.7rem;
      color: #888;
      text-align: center;
    }

    footer span {
      display: block;
    }
  </style>
</head>
<body>
  <div class="app-container">
    <header>
      <button class="back-btn" onclick="goBack()">
        <span class="back-icon">â€¹</span>
      </button>
      <div class="title-box">
        <div class="title-main" id="headerTitle">ê¸°ëŠ¥ì„ ì„ íƒí•˜ì„¸ìš”</div>
        <div class="title-sub" id="headerSub">ì„ íƒí•œ ì–¸ì–´ë¡œ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•˜ì„¸ìš”.</div>
      </div>
      <div class="lang-pill" id="langPill" style="display:none;">
        <span class="lang-flag" id="langFlag">ğŸ³ï¸</span>
        <span class="lang-name" id="langName">Language</span>
      </div>
    </header>

    <main>
      <div class="menu-list" id="menuList">
        <!-- JSë¡œ ì¹´ë“œê°€ ìƒì„±ë©ë‹ˆë‹¤ -->
      </div>
    </main>

    <footer>
      <span>ì „ë‚¨ê²½ì°°ì²­ Â· ì „ë‚¨ìì¹˜ê²½ì°°ìœ„ì›íšŒ</span>
      <span>Jeonnam Police Agency Â· Jeonnam Autonomous Police Commission</span>
    </footer>
  </div>

  <!-- âœ… ì–¸ì–´ ì„¤ì • ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ -->
  <script src="lang-config.js"></script>

  <script>
    // ë’¤ë¡œ ê°€ê¸°
    function goBack() {
      window.history.back();
    }

    // URLì—ì„œ lang íŒŒë¼ë¯¸í„° ê°€ì ¸ì˜¤ê¸° (ì˜ˆ: menu.html?lang=en)
    function getSelectedLangCode() {
      const params = new URLSearchParams(window.location.search);
      const lang = params.get("lang") || "ko";
      return LANG_CONFIG[lang] ? lang : "ko";
    }

    // ìœ í˜•ë³„ ì•„ì´ì½˜ ì§€ì •
    const ICON_MAP = {
      help: "ğŸ‘®",       // ê²½ì°° ì‹ ê³ Â·ìƒë‹´ ì§€ì›
      guide: "ğŸ“˜",      // ë²”ì£„ì˜ˆë°© ê°€ì´ë“œ
      traffic: "ğŸš¦",    // ì•ˆì „í•œ êµí†µìƒí™œ
      drug: "ğŸ’Š",       // ì™¸êµ­ì¸ ë§ˆì•½ ì˜ˆë°© ê°€ì´ë“œ
      safety: "âš ï¸",     // ì•ˆì „ ìˆ˜ì¹™
      rights: "ğŸ›¡ï¸",    // ê¶Œìµë³´í˜¸ ì•ˆë‚´ë¬¸
      law: "ğŸ“š",        // ìƒí™œë²•ë ¹ì •ë³´
      safeApp: "ğŸ“±",    // ë‹¤êµ­ì–´ ì•ˆì „ì „ë‚¨ ì•± (ê¸°ë³¸ê°’, í˜¹ì‹œ ì´ë¯¸ì§€ ë¡œë”© ì•ˆ ë  ë•Œ ëŒ€ë¹„)
      google: "ğŸŒ",     // êµ¬ê¸€ ë²ˆì—­
      default: "â–¶ï¸",
    };

    // âœ… ì¹´ì¹´ì˜¤ ì¸ì•± ë¸Œë¼ìš°ì € & ì‚¼ì„± ì¸í„°ë„·ì—ì„œ PDFì¼ ë•Œ Google Docs viewerë¡œ ìš°íšŒ
    function wrapPdfForSpecialBrowsers(url) {
      if (!url) return url;
      const lowerUrl = url.toLowerCase();
      const isPdf = lowerUrl.endsWith(".pdf");
      if (!isPdf) return url;

      const ua = navigator.userAgent.toLowerCase();
      const isKakaoInApp   = ua.includes("kakaotalk");
      const isSamsungInternet = ua.includes("samsungbrowser");

      // ì¹´ì¹´ì˜¤ ì¸ì•± or ì‚¼ì„± ì¸í„°ë„· + http(s) PDF ì´ë©´ Google Docs ë·°ì–´ ì‚¬ìš©
      if ((isKakaoInApp || isSamsungInternet) &&
          (lowerUrl.startsWith("http://") || lowerUrl.startsWith("https://"))) {
        const encoded = encodeURIComponent(url);
        return `https://docs.google.com/gview?embedded=1&url=${encoded}`;
      }
      return url;
    }

    // ì„ íƒí•œ ì–¸ì–´ì— ë§ì¶° í™”ë©´ ì„¸íŒ…
    const langCode = getSelectedLangCode();
    const cfg = LANG_CONFIG[langCode] || LANG_CONFIG["ko"];

    const headerTitle = document.getElementById("headerTitle");
    const headerSub   = document.getElementById("headerSub");
    const langPill    = document.getElementById("langPill");
    const langFlag    = document.getElementById("langFlag");
    const langName    = document.getElementById("langName");
    const menuList    = document.getElementById("menuList");

    headerTitle.textContent = cfg.headerTitle;
    headerSub.textContent   = cfg.headerSub;

    if (cfg.flag && cfg.name) {
      langPill.style.display = "flex";
      langFlag.textContent = cfg.flag;
      langName.textContent = cfg.name;
    }

    // ë©”ë‰´ ì¹´ë“œ ìƒì„± í•¨ìˆ˜
    function addCard(type, label, desc, url) {
      if (!label || !url) return;

      const a = document.createElement("a");
      a.className = "menu-card";

      // ğŸ”¹ ì‹¤ì œë¡œ ì‚¬ìš©í•  URL (íŠ¹ì • ë¸Œë¼ìš°ì € + PDFë©´ viewerë¡œ ë³€ê²½)
      const finalUrl = wrapPdfForSpecialBrowsers(url);
      a.href = finalUrl;

      // ì™¸ë¶€ ë§í¬ëŠ” ìƒˆ íƒ­ì—ì„œ ì—´ë¦¬ê²Œ
      if (finalUrl.startsWith("http")) {
        a.target = "_blank";
        a.rel = "noopener noreferrer";
      }

      const icon = ICON_MAP[type] || ICON_MAP.default;

      // íƒ€ì…ì´ 'safeApp'ì´ë©´ ì´ë¯¸ì§€ ì•„ì´ì½˜(span + background-image) ì‚¬ìš©
      const iconSpan = (type === "safeApp")
        ? `<span class="menu-card-icon safe-app-icon"></span>`
        : `<span class="menu-card-icon">${icon}</span>`;

      a.innerHTML = `
        <div class="menu-card-main">
          <div class="menu-card-title">
            ${iconSpan}
            <span>${label}</span>
          </div>
          <div class="menu-card-desc">${desc || ""}</div>
        </div>
        <div class="menu-card-arrow">â€º</div>
      `;

      menuList.appendChild(a);
    }

    // ì¹´ë“œ ìƒì„± ìˆœì„œ
    addCard("help",   cfg.helpLabel,    cfg.helpDesc,    cfg.helpUrl);
    addCard("guide",  cfg.guideLabel,   cfg.guideDesc,   cfg.guideUrl);
    if (cfg.trafficLabel) addCard("traffic", cfg.trafficLabel, cfg.trafficDesc, cfg.trafficUrl);
    if (cfg.drugLabel)    addCard("drug",    cfg.drugLabel,    cfg.drugDesc,    cfg.drugUrl);
    if (cfg.safetyLabel)  addCard("safety",  cfg.safetyLabel,  cfg.safetyDesc,  cfg.safetyUrl);
    if (cfg.rightsLabel)  addCard("rights",  cfg.rightsLabel,  cfg.rightsDesc,  cfg.rightsUrl);
    if (cfg.lawLabel)     addCard("law",     cfg.lawLabel,     cfg.lawDesc,     cfg.lawUrl);

    // âœ… ë‹¤êµ­ì–´ ì•ˆì „ì „ë‚¨ ì•± (ìˆì„ ë•Œë§Œ í‘œì‹œ)
    if (cfg.safeAppLabel) {
      addCard("safeApp", cfg.safeAppLabel, cfg.safeAppDesc, cfg.safeAppUrl);
    }

    // âœ… êµ¬ê¸€ ë²ˆì—­ (í•­ìƒ ë§ˆì§€ë§‰)
    addCard("google", cfg.googleLabel, cfg.googleDesc, cfg.googleUrl);
  </script>
</body>
</html>
